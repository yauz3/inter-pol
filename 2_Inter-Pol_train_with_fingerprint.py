import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from math import sqrt
import warnings
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
from sklearn.model_selection import train_test_split, KFold, GridSearchCV
from sklearn.preprocessing import StandardScaler, OneHotEncoder, MinMaxScaler
from sklearn.ensemble import VotingRegressor, RandomForestRegressor, AdaBoostRegressor, ExtraTreesRegressor
from sklearn.linear_model import LinearRegression
from sklearn.svm import SVR
from imodels import GreedyTreeRegressor, RuleFitRegressor, BoostedRulesRegressor, SLIMRegressor, FIGSRegressor, HSTreeRegressorCV, DistilledRegressor
from sklearn.tree import export_text
import pickle
from rulefit import RuleFit
from imodels import RuleFitRegressor
from sklearn.impute import SimpleImputer
import pandas as pd
import numpy as np
from math import sqrt
from sklearn.model_selection import train_test_split, KFold, cross_val_predict
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
from sklearn.impute import SimpleImputer
from rulefit import RuleFit

warnings.filterwarnings("ignore")

# ðŸ“Œ Veri YÃ¼kleme
train_df = pd.read_csv("train_avalon_morgan_maccs.csv")
test_df = pd.read_csv("test_avalon_morgan_maccs.csv")
# ðŸ“Œ Hedef deÄŸiÅŸken
target = "Et(30)"

# ðŸ“Œ Gereksiz sÃ¼tunlarÄ± kaldÄ±rma
drop_cols = ["Name of the Molecule", "Smiles"]
train_df = train_df.drop(columns=drop_cols, errors='ignore')
test_df = test_df.drop(columns=drop_cols, errors='ignore')

# ðŸ“Œ Kategorik deÄŸiÅŸkenleri encode etme
categorical_features = ["Solvent type"]
encoder = OneHotEncoder(sparse_output=False, drop='first')
encoded_train = pd.DataFrame(encoder.fit_transform(train_df[categorical_features]))
encoded_test = pd.DataFrame(encoder.transform(test_df[categorical_features]))

encoded_train.columns = encoder.get_feature_names_out(categorical_features)
encoded_test.columns = encoder.get_feature_names_out(categorical_features)

train_df = train_df.drop(columns=categorical_features).join(encoded_train)
test_df = test_df.drop(columns=categorical_features).join(encoded_test)
k_fold_feature_selection=[
    'Avalon_FP_0', 'Avalon_FP_1', 'Avalon_FP_2', 'Avalon_FP_3', 'Avalon_FP_4', 'Avalon_FP_5', 'Avalon_FP_6', 'Avalon_FP_7', 'Avalon_FP_8', 'Avalon_FP_9', 'Avalon_FP_10', 'Avalon_FP_11', 'Avalon_FP_12', 'Avalon_FP_13', 'Avalon_FP_14', 'Avalon_FP_15', 'Avalon_FP_16', 'Avalon_FP_17', 'Avalon_FP_18', 'Avalon_FP_19', 'Avalon_FP_20', 'Avalon_FP_21', 'Avalon_FP_22', 'Avalon_FP_23', 'Avalon_FP_24', 'Avalon_FP_25', 'Avalon_FP_26', 'Avalon_FP_27', 'Avalon_FP_28', 'Avalon_FP_29', 'Avalon_FP_30', 'Avalon_FP_31', 'Avalon_FP_32', 'Avalon_FP_33', 'Avalon_FP_34', 'Avalon_FP_35', 'Avalon_FP_36', 'Avalon_FP_37', 'Avalon_FP_38', 'Avalon_FP_39', 'Avalon_FP_40', 'Avalon_FP_41', 'Avalon_FP_42', 'Avalon_FP_43', 'Avalon_FP_44', 'Avalon_FP_45', 'Avalon_FP_46', 'Avalon_FP_47', 'Avalon_FP_48', 'Avalon_FP_49', 'Avalon_FP_50', 'Avalon_FP_51', 'Avalon_FP_52', 'Avalon_FP_53', 'Avalon_FP_54', 'Avalon_FP_55', 'Avalon_FP_56', 'Avalon_FP_57', 'Avalon_FP_58', 'Avalon_FP_59', 'Avalon_FP_60', 'Avalon_FP_61', 'Avalon_FP_62', 'Avalon_FP_63', 'Avalon_FP_64', 'Avalon_FP_65', 'Avalon_FP_66', 'Avalon_FP_67', 'Avalon_FP_68', 'Avalon_FP_69', 'Avalon_FP_70', 'Avalon_FP_71', 'Avalon_FP_72', 'Avalon_FP_73', 'Avalon_FP_74', 'Avalon_FP_75', 'Avalon_FP_76', 'Avalon_FP_77', 'Avalon_FP_78', 'Avalon_FP_79', 'Avalon_FP_80', 'Avalon_FP_81', 'Avalon_FP_82', 'Avalon_FP_83', 'Avalon_FP_84', 'Avalon_FP_85', 'Avalon_FP_86', 'Avalon_FP_87', 'Avalon_FP_88', 'Avalon_FP_89', 'Avalon_FP_90', 'Avalon_FP_91', 'Avalon_FP_92', 'Avalon_FP_93', 'Avalon_FP_94', 'Avalon_FP_95', 'Avalon_FP_96', 'Avalon_FP_97', 'Avalon_FP_98', 'Avalon_FP_99', 'Avalon_FP_100', 'Avalon_FP_101', 'Avalon_FP_102', 'Avalon_FP_103', 'Avalon_FP_104', 'Avalon_FP_105', 'Avalon_FP_106', 'Avalon_FP_107', 'Avalon_FP_108', 'Avalon_FP_109', 'Avalon_FP_110', 'Avalon_FP_111', 'Avalon_FP_112', 'Avalon_FP_113', 'Avalon_FP_114', 'Avalon_FP_115', 'Avalon_FP_116', 'Avalon_FP_117', 'Avalon_FP_118', 'Avalon_FP_119', 'Avalon_FP_120', 'Avalon_FP_121', 'Avalon_FP_122', 'Avalon_FP_123', 'Avalon_FP_124', 'Avalon_FP_125', 'Avalon_FP_126', 'Avalon_FP_127', 'Avalon_FP_128', 'Avalon_FP_129', 'Avalon_FP_130', 'Avalon_FP_131', 'Avalon_FP_132', 'Avalon_FP_133', 'Avalon_FP_134', 'Avalon_FP_135', 'Avalon_FP_136', 'Avalon_FP_137', 'Avalon_FP_138', 'Avalon_FP_139', 'Avalon_FP_140', 'Avalon_FP_141', 'Avalon_FP_142', 'Avalon_FP_143', 'Avalon_FP_144', 'Avalon_FP_145', 'Avalon_FP_146', 'Avalon_FP_147', 'Avalon_FP_148', 'Avalon_FP_149', 'Avalon_FP_150', 'Avalon_FP_151', 'Avalon_FP_152', 'Avalon_FP_153', 'Avalon_FP_154', 'Avalon_FP_155', 'Avalon_FP_156', 'Avalon_FP_157', 'Avalon_FP_158', 'Avalon_FP_159', 'Avalon_FP_160', 'Avalon_FP_161', 'Avalon_FP_162', 'Avalon_FP_163', 'Avalon_FP_164', 'Avalon_FP_165', 'Avalon_FP_166', 'Avalon_FP_167', 'Avalon_FP_168', 'Avalon_FP_169', 'Avalon_FP_170', 'Avalon_FP_171', 'Avalon_FP_172', 'Avalon_FP_173', 'Avalon_FP_174', 'Avalon_FP_175', 'Avalon_FP_176', 'Avalon_FP_177', 'Avalon_FP_178', 'Avalon_FP_179', 'Avalon_FP_180', 'Avalon_FP_181', 'Avalon_FP_182', 'Avalon_FP_183', 'Avalon_FP_184', 'Avalon_FP_185', 'Avalon_FP_186', 'Avalon_FP_187', 'Avalon_FP_188', 'Avalon_FP_189', 'Avalon_FP_190', 'Avalon_FP_191', 'Avalon_FP_192', 'Avalon_FP_193', 'Avalon_FP_194', 'Avalon_FP_195', 'Avalon_FP_196', 'Avalon_FP_197', 'Avalon_FP_198', 'Avalon_FP_199', 'Avalon_FP_200', 'Avalon_FP_201', 'Avalon_FP_202', 'Avalon_FP_203', 'Avalon_FP_204', 'Avalon_FP_205', 'Avalon_FP_206', 'Avalon_FP_207', 'Avalon_FP_208', 'Avalon_FP_209', 'Avalon_FP_210', 'Avalon_FP_211', 'Avalon_FP_212', 'Avalon_FP_213', 'Avalon_FP_214', 'Avalon_FP_215', 'Avalon_FP_216', 'Avalon_FP_217', 'Avalon_FP_218', 'Avalon_FP_219', 'Avalon_FP_220', 'Avalon_FP_221', 'Avalon_FP_222', 'Avalon_FP_223', 'Avalon_FP_224', 'Avalon_FP_225', 'Avalon_FP_226', 'Avalon_FP_227', 'Avalon_FP_228', 'Avalon_FP_229', 'Avalon_FP_230', 'Avalon_FP_231', 'Avalon_FP_232', 'Avalon_FP_233', 'Avalon_FP_234', 'Avalon_FP_235', 'Avalon_FP_236', 'Avalon_FP_237', 'Avalon_FP_238', 'Avalon_FP_239', 'Avalon_FP_240', 'Avalon_FP_241', 'Avalon_FP_242', 'Avalon_FP_243', 'Avalon_FP_244', 'Avalon_FP_245', 'Avalon_FP_246', 'Avalon_FP_247', 'Avalon_FP_248', 'Avalon_FP_249', 'Avalon_FP_250', 'Avalon_FP_251', 'Avalon_FP_252', 'Avalon_FP_253', 'Avalon_FP_254', 'Avalon_FP_255', 'Avalon_FP_256', 'Avalon_FP_257', 'Avalon_FP_258', 'Avalon_FP_259', 'Avalon_FP_260', 'Avalon_FP_261', 'Avalon_FP_262', 'Avalon_FP_263', 'Avalon_FP_264', 'Avalon_FP_265', 'Avalon_FP_266', 'Avalon_FP_267', 'Avalon_FP_268', 'Avalon_FP_269', 'Avalon_FP_270', 'Avalon_FP_271', 'Avalon_FP_272', 'Avalon_FP_273', 'Avalon_FP_274', 'Avalon_FP_275', 'Avalon_FP_276', 'Avalon_FP_277', 'Avalon_FP_278', 'Avalon_FP_279', 'Avalon_FP_280', 'Avalon_FP_281', 'Avalon_FP_282', 'Avalon_FP_283', 'Avalon_FP_284', 'Avalon_FP_285', 'Avalon_FP_286', 'Avalon_FP_287', 'Avalon_FP_288', 'Avalon_FP_289', 'Avalon_FP_290', 'Avalon_FP_291', 'Avalon_FP_292', 'Avalon_FP_293', 'Avalon_FP_294', 'Avalon_FP_295', 'Avalon_FP_296', 'Avalon_FP_297', 'Avalon_FP_298', 'Avalon_FP_299', 'Avalon_FP_300', 'Avalon_FP_301', 'Avalon_FP_302', 'Avalon_FP_303', 'Avalon_FP_304', 'Avalon_FP_305', 'Avalon_FP_306', 'Avalon_FP_307', 'Avalon_FP_308', 'Avalon_FP_309', 'Avalon_FP_310', 'Avalon_FP_311', 'Avalon_FP_312', 'Avalon_FP_313', 'Avalon_FP_314', 'Avalon_FP_315', 'Avalon_FP_316', 'Avalon_FP_317', 'Avalon_FP_318', 'Avalon_FP_319', 'Avalon_FP_320', 'Avalon_FP_321', 'Avalon_FP_322', 'Avalon_FP_323', 'Avalon_FP_324', 'Avalon_FP_325', 'Avalon_FP_326', 'Avalon_FP_327', 'Avalon_FP_328', 'Avalon_FP_329', 'Avalon_FP_330', 'Avalon_FP_331', 'Avalon_FP_332', 'Avalon_FP_333', 'Avalon_FP_334', 'Avalon_FP_335', 'Avalon_FP_336', 'Avalon_FP_337', 'Avalon_FP_338', 'Avalon_FP_339', 'Avalon_FP_340', 'Avalon_FP_341', 'Avalon_FP_342', 'Avalon_FP_343', 'Avalon_FP_344', 'Avalon_FP_345', 'Avalon_FP_346', 'Avalon_FP_347', 'Avalon_FP_348', 'Avalon_FP_349', 'Avalon_FP_350', 'Avalon_FP_351', 'Avalon_FP_352', 'Avalon_FP_353', 'Avalon_FP_354', 'Avalon_FP_355', 'Avalon_FP_356', 'Avalon_FP_357', 'Avalon_FP_358', 'Avalon_FP_359', 'Avalon_FP_360', 'Avalon_FP_361', 'Avalon_FP_362', 'Avalon_FP_363', 'Avalon_FP_364', 'Avalon_FP_365', 'Avalon_FP_366', 'Avalon_FP_367', 'Avalon_FP_368', 'Avalon_FP_369', 'Avalon_FP_370', 'Avalon_FP_371', 'Avalon_FP_372', 'Avalon_FP_373', 'Avalon_FP_374', 'Avalon_FP_375', 'Avalon_FP_376', 'Avalon_FP_377', 'Avalon_FP_378', 'Avalon_FP_379', 'Avalon_FP_380', 'Avalon_FP_381', 'Avalon_FP_382', 'Avalon_FP_383', 'Avalon_FP_384', 'Avalon_FP_385', 'Avalon_FP_386', 'Avalon_FP_387', 'Avalon_FP_388', 'Avalon_FP_389', 'Avalon_FP_390', 'Avalon_FP_391', 'Avalon_FP_392', 'Avalon_FP_393', 'Avalon_FP_394', 'Avalon_FP_395', 'Avalon_FP_396', 'Avalon_FP_397', 'Avalon_FP_398', 'Avalon_FP_399', 'Avalon_FP_400', 'Avalon_FP_401', 'Avalon_FP_402', 'Avalon_FP_403', 'Avalon_FP_404', 'Avalon_FP_405', 'Avalon_FP_406', 'Avalon_FP_407', 'Avalon_FP_408', 'Avalon_FP_409', 'Avalon_FP_410', 'Avalon_FP_411', 'Avalon_FP_412', 'Avalon_FP_413', 'Avalon_FP_414', 'Avalon_FP_415', 'Avalon_FP_416', 'Avalon_FP_417', 'Avalon_FP_418', 'Avalon_FP_419', 'Avalon_FP_420', 'Avalon_FP_421', 'Avalon_FP_422', 'Avalon_FP_423', 'Avalon_FP_424', 'Avalon_FP_425', 'Avalon_FP_426', 'Avalon_FP_427', 'Avalon_FP_428', 'Avalon_FP_429', 'Avalon_FP_430', 'Avalon_FP_431', 'Avalon_FP_432', 'Avalon_FP_433', 'Avalon_FP_434', 'Avalon_FP_435', 'Avalon_FP_436', 'Avalon_FP_437', 'Avalon_FP_438', 'Avalon_FP_439', 'Avalon_FP_440', 'Avalon_FP_441', 'Avalon_FP_442', 'Avalon_FP_443', 'Avalon_FP_444', 'Avalon_FP_445', 'Avalon_FP_446', 'Avalon_FP_447', 'Avalon_FP_448', 'Avalon_FP_449', 'Avalon_FP_450', 'Avalon_FP_451', 'Avalon_FP_452', 'Avalon_FP_453', 'Avalon_FP_454', 'Avalon_FP_455', 'Avalon_FP_456', 'Avalon_FP_457', 'Avalon_FP_458', 'Avalon_FP_459', 'Avalon_FP_460', 'Avalon_FP_461', 'Avalon_FP_462', 'Avalon_FP_463', 'Avalon_FP_464', 'Avalon_FP_465', 'Avalon_FP_466', 'Avalon_FP_467', 'Avalon_FP_468', 'Avalon_FP_469', 'Avalon_FP_470', 'Avalon_FP_471', 'Avalon_FP_472', 'Avalon_FP_473', 'Avalon_FP_474', 'Avalon_FP_475', 'Avalon_FP_476', 'Avalon_FP_477', 'Avalon_FP_478', 'Avalon_FP_479', 'Avalon_FP_480', 'Avalon_FP_481', 'Avalon_FP_482', 'Avalon_FP_483', 'Avalon_FP_484', 'Avalon_FP_485', 'Avalon_FP_486', 'Avalon_FP_487', 'Avalon_FP_488', 'Avalon_FP_489', 'Avalon_FP_490', 'Avalon_FP_491', 'Avalon_FP_492', 'Avalon_FP_493', 'Avalon_FP_494', 'Avalon_FP_495', 'Avalon_FP_496', 'Avalon_FP_497', 'Avalon_FP_498', 'Avalon_FP_499', 'Avalon_FP_500', 'Avalon_FP_501', 'Avalon_FP_502', 'Avalon_FP_503', 'Avalon_FP_504', 'Avalon_FP_505', 'Avalon_FP_506', 'Avalon_FP_507', 'Avalon_FP_508', 'Avalon_FP_509', 'Avalon_FP_510', 'Avalon_FP_511',
    'Morgan_FP_0', 'Morgan_FP_1', 'Morgan_FP_2', 'Morgan_FP_3', 'Morgan_FP_4', 'Morgan_FP_5', 'Morgan_FP_6', 'Morgan_FP_7', 'Morgan_FP_8', 'Morgan_FP_9', 'Morgan_FP_10', 'Morgan_FP_11', 'Morgan_FP_12', 'Morgan_FP_13', 'Morgan_FP_14', 'Morgan_FP_15', 'Morgan_FP_16', 'Morgan_FP_17', 'Morgan_FP_18', 'Morgan_FP_19', 'Morgan_FP_20', 'Morgan_FP_21', 'Morgan_FP_22', 'Morgan_FP_23', 'Morgan_FP_24', 'Morgan_FP_25', 'Morgan_FP_26', 'Morgan_FP_27', 'Morgan_FP_28', 'Morgan_FP_29', 'Morgan_FP_30', 'Morgan_FP_31', 'Morgan_FP_32', 'Morgan_FP_33', 'Morgan_FP_34', 'Morgan_FP_35', 'Morgan_FP_36', 'Morgan_FP_37', 'Morgan_FP_38', 'Morgan_FP_39', 'Morgan_FP_40', 'Morgan_FP_41', 'Morgan_FP_42', 'Morgan_FP_43', 'Morgan_FP_44', 'Morgan_FP_45', 'Morgan_FP_46', 'Morgan_FP_47', 'Morgan_FP_48', 'Morgan_FP_49', 'Morgan_FP_50', 'Morgan_FP_51', 'Morgan_FP_52', 'Morgan_FP_53', 'Morgan_FP_54', 'Morgan_FP_55', 'Morgan_FP_56', 'Morgan_FP_57', 'Morgan_FP_58', 'Morgan_FP_59', 'Morgan_FP_60', 'Morgan_FP_61', 'Morgan_FP_62', 'Morgan_FP_63', 'Morgan_FP_64', 'Morgan_FP_65', 'Morgan_FP_66', 'Morgan_FP_67', 'Morgan_FP_68', 'Morgan_FP_69', 'Morgan_FP_70', 'Morgan_FP_71', 'Morgan_FP_72', 'Morgan_FP_73', 'Morgan_FP_74', 'Morgan_FP_75', 'Morgan_FP_76', 'Morgan_FP_77', 'Morgan_FP_78', 'Morgan_FP_79', 'Morgan_FP_80', 'Morgan_FP_81', 'Morgan_FP_82', 'Morgan_FP_83', 'Morgan_FP_84', 'Morgan_FP_85', 'Morgan_FP_86', 'Morgan_FP_87', 'Morgan_FP_88', 'Morgan_FP_89', 'Morgan_FP_90', 'Morgan_FP_91', 'Morgan_FP_92', 'Morgan_FP_93', 'Morgan_FP_94', 'Morgan_FP_95', 'Morgan_FP_96', 'Morgan_FP_97', 'Morgan_FP_98', 'Morgan_FP_99', 'Morgan_FP_100', 'Morgan_FP_101', 'Morgan_FP_102', 'Morgan_FP_103', 'Morgan_FP_104', 'Morgan_FP_105', 'Morgan_FP_106', 'Morgan_FP_107', 'Morgan_FP_108', 'Morgan_FP_109', 'Morgan_FP_110', 'Morgan_FP_111', 'Morgan_FP_112', 'Morgan_FP_113', 'Morgan_FP_114', 'Morgan_FP_115', 'Morgan_FP_116', 'Morgan_FP_117', 'Morgan_FP_118', 'Morgan_FP_119', 'Morgan_FP_120', 'Morgan_FP_121', 'Morgan_FP_122', 'Morgan_FP_123', 'Morgan_FP_124', 'Morgan_FP_125', 'Morgan_FP_126', 'Morgan_FP_127', 'Morgan_FP_128', 'Morgan_FP_129', 'Morgan_FP_130', 'Morgan_FP_131', 'Morgan_FP_132', 'Morgan_FP_133', 'Morgan_FP_134', 'Morgan_FP_135', 'Morgan_FP_136', 'Morgan_FP_137', 'Morgan_FP_138', 'Morgan_FP_139', 'Morgan_FP_140', 'Morgan_FP_141', 'Morgan_FP_142', 'Morgan_FP_143', 'Morgan_FP_144', 'Morgan_FP_145', 'Morgan_FP_146', 'Morgan_FP_147', 'Morgan_FP_148', 'Morgan_FP_149', 'Morgan_FP_150', 'Morgan_FP_151', 'Morgan_FP_152', 'Morgan_FP_153', 'Morgan_FP_154', 'Morgan_FP_155', 'Morgan_FP_156', 'Morgan_FP_157', 'Morgan_FP_158', 'Morgan_FP_159', 'Morgan_FP_160', 'Morgan_FP_161', 'Morgan_FP_162', 'Morgan_FP_163', 'Morgan_FP_164', 'Morgan_FP_165', 'Morgan_FP_166', 'Morgan_FP_167', 'Morgan_FP_168', 'Morgan_FP_169', 'Morgan_FP_170', 'Morgan_FP_171', 'Morgan_FP_172', 'Morgan_FP_173', 'Morgan_FP_174', 'Morgan_FP_175', 'Morgan_FP_176', 'Morgan_FP_177', 'Morgan_FP_178', 'Morgan_FP_179', 'Morgan_FP_180', 'Morgan_FP_181', 'Morgan_FP_182', 'Morgan_FP_183', 'Morgan_FP_184', 'Morgan_FP_185', 'Morgan_FP_186', 'Morgan_FP_187', 'Morgan_FP_188', 'Morgan_FP_189', 'Morgan_FP_190', 'Morgan_FP_191', 'Morgan_FP_192', 'Morgan_FP_193', 'Morgan_FP_194', 'Morgan_FP_195', 'Morgan_FP_196', 'Morgan_FP_197', 'Morgan_FP_198', 'Morgan_FP_199', 'Morgan_FP_200', 'Morgan_FP_201', 'Morgan_FP_202', 'Morgan_FP_203', 'Morgan_FP_204', 'Morgan_FP_205', 'Morgan_FP_206', 'Morgan_FP_207', 'Morgan_FP_208', 'Morgan_FP_209', 'Morgan_FP_210', 'Morgan_FP_211', 'Morgan_FP_212', 'Morgan_FP_213', 'Morgan_FP_214', 'Morgan_FP_215', 'Morgan_FP_216', 'Morgan_FP_217', 'Morgan_FP_218', 'Morgan_FP_219', 'Morgan_FP_220', 'Morgan_FP_221', 'Morgan_FP_222', 'Morgan_FP_223', 'Morgan_FP_224', 'Morgan_FP_225', 'Morgan_FP_226', 'Morgan_FP_227', 'Morgan_FP_228', 'Morgan_FP_229', 'Morgan_FP_230', 'Morgan_FP_231', 'Morgan_FP_232', 'Morgan_FP_233', 'Morgan_FP_234', 'Morgan_FP_235', 'Morgan_FP_236', 'Morgan_FP_237', 'Morgan_FP_238', 'Morgan_FP_239', 'Morgan_FP_240', 'Morgan_FP_241', 'Morgan_FP_242', 'Morgan_FP_243', 'Morgan_FP_244', 'Morgan_FP_245', 'Morgan_FP_246', 'Morgan_FP_247', 'Morgan_FP_248', 'Morgan_FP_249', 'Morgan_FP_250', 'Morgan_FP_251', 'Morgan_FP_252', 'Morgan_FP_253', 'Morgan_FP_254', 'Morgan_FP_255', 'Morgan_FP_256', 'Morgan_FP_257', 'Morgan_FP_258', 'Morgan_FP_259', 'Morgan_FP_260', 'Morgan_FP_261', 'Morgan_FP_262', 'Morgan_FP_263', 'Morgan_FP_264', 'Morgan_FP_265', 'Morgan_FP_266', 'Morgan_FP_267', 'Morgan_FP_268', 'Morgan_FP_269', 'Morgan_FP_270', 'Morgan_FP_271', 'Morgan_FP_272', 'Morgan_FP_273', 'Morgan_FP_274', 'Morgan_FP_275', 'Morgan_FP_276', 'Morgan_FP_277', 'Morgan_FP_278', 'Morgan_FP_279', 'Morgan_FP_280', 'Morgan_FP_281', 'Morgan_FP_282', 'Morgan_FP_283', 'Morgan_FP_284', 'Morgan_FP_285', 'Morgan_FP_286', 'Morgan_FP_287', 'Morgan_FP_288', 'Morgan_FP_289', 'Morgan_FP_290', 'Morgan_FP_291', 'Morgan_FP_292', 'Morgan_FP_293', 'Morgan_FP_294', 'Morgan_FP_295', 'Morgan_FP_296', 'Morgan_FP_297', 'Morgan_FP_298', 'Morgan_FP_299', 'Morgan_FP_300', 'Morgan_FP_301', 'Morgan_FP_302', 'Morgan_FP_303', 'Morgan_FP_304', 'Morgan_FP_305', 'Morgan_FP_306', 'Morgan_FP_307', 'Morgan_FP_308', 'Morgan_FP_309', 'Morgan_FP_310', 'Morgan_FP_311', 'Morgan_FP_312', 'Morgan_FP_313', 'Morgan_FP_314', 'Morgan_FP_315', 'Morgan_FP_316', 'Morgan_FP_317', 'Morgan_FP_318', 'Morgan_FP_319', 'Morgan_FP_320', 'Morgan_FP_321', 'Morgan_FP_322', 'Morgan_FP_323', 'Morgan_FP_324', 'Morgan_FP_325', 'Morgan_FP_326', 'Morgan_FP_327', 'Morgan_FP_328', 'Morgan_FP_329', 'Morgan_FP_330', 'Morgan_FP_331', 'Morgan_FP_332', 'Morgan_FP_333', 'Morgan_FP_334', 'Morgan_FP_335', 'Morgan_FP_336', 'Morgan_FP_337', 'Morgan_FP_338', 'Morgan_FP_339', 'Morgan_FP_340', 'Morgan_FP_341', 'Morgan_FP_342', 'Morgan_FP_343', 'Morgan_FP_344', 'Morgan_FP_345', 'Morgan_FP_346', 'Morgan_FP_347', 'Morgan_FP_348', 'Morgan_FP_349', 'Morgan_FP_350', 'Morgan_FP_351', 'Morgan_FP_352', 'Morgan_FP_353', 'Morgan_FP_354', 'Morgan_FP_355', 'Morgan_FP_356', 'Morgan_FP_357', 'Morgan_FP_358', 'Morgan_FP_359', 'Morgan_FP_360', 'Morgan_FP_361', 'Morgan_FP_362', 'Morgan_FP_363', 'Morgan_FP_364', 'Morgan_FP_365', 'Morgan_FP_366', 'Morgan_FP_367', 'Morgan_FP_368', 'Morgan_FP_369', 'Morgan_FP_370', 'Morgan_FP_371', 'Morgan_FP_372', 'Morgan_FP_373', 'Morgan_FP_374', 'Morgan_FP_375', 'Morgan_FP_376', 'Morgan_FP_377', 'Morgan_FP_378', 'Morgan_FP_379', 'Morgan_FP_380', 'Morgan_FP_381', 'Morgan_FP_382', 'Morgan_FP_383', 'Morgan_FP_384', 'Morgan_FP_385', 'Morgan_FP_386', 'Morgan_FP_387', 'Morgan_FP_388', 'Morgan_FP_389', 'Morgan_FP_390', 'Morgan_FP_391', 'Morgan_FP_392', 'Morgan_FP_393', 'Morgan_FP_394', 'Morgan_FP_395', 'Morgan_FP_396', 'Morgan_FP_397', 'Morgan_FP_398', 'Morgan_FP_399', 'Morgan_FP_400', 'Morgan_FP_401', 'Morgan_FP_402', 'Morgan_FP_403', 'Morgan_FP_404', 'Morgan_FP_405', 'Morgan_FP_406', 'Morgan_FP_407', 'Morgan_FP_408', 'Morgan_FP_409', 'Morgan_FP_410', 'Morgan_FP_411', 'Morgan_FP_412', 'Morgan_FP_413', 'Morgan_FP_414', 'Morgan_FP_415', 'Morgan_FP_416', 'Morgan_FP_417', 'Morgan_FP_418', 'Morgan_FP_419', 'Morgan_FP_420', 'Morgan_FP_421', 'Morgan_FP_422', 'Morgan_FP_423', 'Morgan_FP_424', 'Morgan_FP_425', 'Morgan_FP_426', 'Morgan_FP_427', 'Morgan_FP_428', 'Morgan_FP_429', 'Morgan_FP_430', 'Morgan_FP_431', 'Morgan_FP_432', 'Morgan_FP_433', 'Morgan_FP_434', 'Morgan_FP_435', 'Morgan_FP_436', 'Morgan_FP_437', 'Morgan_FP_438', 'Morgan_FP_439', 'Morgan_FP_440', 'Morgan_FP_441', 'Morgan_FP_442', 'Morgan_FP_443', 'Morgan_FP_444', 'Morgan_FP_445', 'Morgan_FP_446', 'Morgan_FP_447', 'Morgan_FP_448', 'Morgan_FP_449', 'Morgan_FP_450', 'Morgan_FP_451', 'Morgan_FP_452', 'Morgan_FP_453', 'Morgan_FP_454', 'Morgan_FP_455', 'Morgan_FP_456', 'Morgan_FP_457', 'Morgan_FP_458', 'Morgan_FP_459', 'Morgan_FP_460', 'Morgan_FP_461', 'Morgan_FP_462', 'Morgan_FP_463', 'Morgan_FP_464', 'Morgan_FP_465', 'Morgan_FP_466', 'Morgan_FP_467', 'Morgan_FP_468', 'Morgan_FP_469', 'Morgan_FP_470', 'Morgan_FP_471', 'Morgan_FP_472', 'Morgan_FP_473', 'Morgan_FP_474', 'Morgan_FP_475', 'Morgan_FP_476', 'Morgan_FP_477', 'Morgan_FP_478', 'Morgan_FP_479', 'Morgan_FP_480', 'Morgan_FP_481', 'Morgan_FP_482', 'Morgan_FP_483', 'Morgan_FP_484', 'Morgan_FP_485', 'Morgan_FP_486', 'Morgan_FP_487', 'Morgan_FP_488', 'Morgan_FP_489', 'Morgan_FP_490', 'Morgan_FP_491', 'Morgan_FP_492', 'Morgan_FP_493', 'Morgan_FP_494', 'Morgan_FP_495', 'Morgan_FP_496', 'Morgan_FP_497', 'Morgan_FP_498', 'Morgan_FP_499', 'Morgan_FP_500', 'Morgan_FP_501', 'Morgan_FP_502', 'Morgan_FP_503', 'Morgan_FP_504', 'Morgan_FP_505', 'Morgan_FP_506', 'Morgan_FP_507', 'Morgan_FP_508', 'Morgan_FP_509', 'Morgan_FP_510', 'Morgan_FP_511',
    'MACCS_FP_0', 'MACCS_FP_1', 'MACCS_FP_2', 'MACCS_FP_3', 'MACCS_FP_4', 'MACCS_FP_5', 'MACCS_FP_6', 'MACCS_FP_7', 'MACCS_FP_8', 'MACCS_FP_9', 'MACCS_FP_10', 'MACCS_FP_11', 'MACCS_FP_12', 'MACCS_FP_13', 'MACCS_FP_14', 'MACCS_FP_15', 'MACCS_FP_16', 'MACCS_FP_17', 'MACCS_FP_18', 'MACCS_FP_19', 'MACCS_FP_20', 'MACCS_FP_21', 'MACCS_FP_22', 'MACCS_FP_23', 'MACCS_FP_24', 'MACCS_FP_25', 'MACCS_FP_26', 'MACCS_FP_27', 'MACCS_FP_28', 'MACCS_FP_29', 'MACCS_FP_30', 'MACCS_FP_31', 'MACCS_FP_32', 'MACCS_FP_33', 'MACCS_FP_34', 'MACCS_FP_35', 'MACCS_FP_36', 'MACCS_FP_37', 'MACCS_FP_38', 'MACCS_FP_39', 'MACCS_FP_40', 'MACCS_FP_41', 'MACCS_FP_42', 'MACCS_FP_43', 'MACCS_FP_44', 'MACCS_FP_45', 'MACCS_FP_46', 'MACCS_FP_47', 'MACCS_FP_48', 'MACCS_FP_49', 'MACCS_FP_50', 'MACCS_FP_51', 'MACCS_FP_52', 'MACCS_FP_53', 'MACCS_FP_54', 'MACCS_FP_55', 'MACCS_FP_56', 'MACCS_FP_57', 'MACCS_FP_58', 'MACCS_FP_59', 'MACCS_FP_60', 'MACCS_FP_61', 'MACCS_FP_62', 'MACCS_FP_63', 'MACCS_FP_64', 'MACCS_FP_65', 'MACCS_FP_66', 'MACCS_FP_67', 'MACCS_FP_68', 'MACCS_FP_69', 'MACCS_FP_70', 'MACCS_FP_71', 'MACCS_FP_72', 'MACCS_FP_73', 'MACCS_FP_74', 'MACCS_FP_75', 'MACCS_FP_76', 'MACCS_FP_77', 'MACCS_FP_78', 'MACCS_FP_79', 'MACCS_FP_80', 'MACCS_FP_81', 'MACCS_FP_82', 'MACCS_FP_83', 'MACCS_FP_84', 'MACCS_FP_85', 'MACCS_FP_86', 'MACCS_FP_87', 'MACCS_FP_88', 'MACCS_FP_89', 'MACCS_FP_90', 'MACCS_FP_91', 'MACCS_FP_92', 'MACCS_FP_93', 'MACCS_FP_94', 'MACCS_FP_95', 'MACCS_FP_96', 'MACCS_FP_97', 'MACCS_FP_98', 'MACCS_FP_99', 'MACCS_FP_100', 'MACCS_FP_101', 'MACCS_FP_102', 'MACCS_FP_103', 'MACCS_FP_104', 'MACCS_FP_105', 'MACCS_FP_106', 'MACCS_FP_107', 'MACCS_FP_108', 'MACCS_FP_109', 'MACCS_FP_110', 'MACCS_FP_111', 'MACCS_FP_112', 'MACCS_FP_113', 'MACCS_FP_114', 'MACCS_FP_115', 'MACCS_FP_116', 'MACCS_FP_117', 'MACCS_FP_118', 'MACCS_FP_119', 'MACCS_FP_120', 'MACCS_FP_121', 'MACCS_FP_122', 'MACCS_FP_123', 'MACCS_FP_124', 'MACCS_FP_125', 'MACCS_FP_126', 'MACCS_FP_127', 'MACCS_FP_128', 'MACCS_FP_129', 'MACCS_FP_130', 'MACCS_FP_131', 'MACCS_FP_132', 'MACCS_FP_133', 'MACCS_FP_134', 'MACCS_FP_135', 'MACCS_FP_136', 'MACCS_FP_137', 'MACCS_FP_138', 'MACCS_FP_139', 'MACCS_FP_140', 'MACCS_FP_141', 'MACCS_FP_142', 'MACCS_FP_143', 'MACCS_FP_144', 'MACCS_FP_145', 'MACCS_FP_146', 'MACCS_FP_147', 'MACCS_FP_148', 'MACCS_FP_149', 'MACCS_FP_150', 'MACCS_FP_151', 'MACCS_FP_152', 'MACCS_FP_153', 'MACCS_FP_154', 'MACCS_FP_155', 'MACCS_FP_156', 'MACCS_FP_157', 'MACCS_FP_158', 'MACCS_FP_159', 'MACCS_FP_160', 'MACCS_FP_161', 'MACCS_FP_162', 'MACCS_FP_163', 'MACCS_FP_164', 'MACCS_FP_165', 'MACCS_FP_166',
    'N-Het', 'E(Energy)', 'E(HOMO)', 'E(LUMO)', 'ê­“(Electronegativity)', 'Âµ(Chemical Potential)', 'É³(Hardness)', 'Ñ (Electophilicity Index)', 'd(Dipole Moment)', 'H(Enthalpy)', 'G(Gibbs Free Energy)', 'Et(30)', 'MolWt', 'LogP', 'HBD', 'HBA', 'TPSA', 'RotatableBonds', 'nBonds', 'nBondsO', 'nBondsS', 'nBondsD', 'nBondsT', 'nBondsA', 'nBondsM', 'nBondsKS', 'nBondsKD', 'VAdjMat', 'BertzCT', 'NsLi', 'NssBe', 'NssssBe', 'NssBH', 'NsssB', 'NssssB', 'NsCH3', 'NdCH2', 'NssCH2', 'NtCH', 'NdsCH', 'NaaCH', 'NsssCH', 'NddC', 'NtsC', 'NdssC', 'NaasC', 'NaaaC', 'NssssC', 'NsNH3', 'NsNH2', 'NssNH2', 'NdNH', 'NssNH', 'NaaNH', 'NtN', 'NsssNH', 'NdsN', 'NaaN', 'NsssN', 'NddsN', 'NaasN', 'NssssN', 'NsOH', 'NdO', 'NssO', 'NaaO', 'NsF', 'NsSiH3', 'NssSiH2', 'NsssSiH', 'NssssSi', 'NsPH2', 'NssPH', 'NsssP', 'NdsssP', 'NsssssP', 'NsSH', 'NdS', 'NssS', 'NaaS', 'NdssS', 'NddssS', 'NsCl', 'NsGeH3', 'NssGeH2', 'NsssGeH', 'NssssGe', 'NsAsH2', 'NssAsH', 'NsssAs', 'NsssdAs', 'NsssssAs', 'NsSeH', 'NdSe', 'NssSe', 'NaaSe', 'NdssSe', 'NddssSe', 'NsBr', 'NsSnH3', 'NssSnH2', 'NsssSnH', 'NssssSn', 'NsI', 'NsPbH3', 'NssPbH2', 'NsssPbH', 'NssssPb', 'SsLi', 'SssBe', 'SssssBe', 'SssBH', 'SsssB', 'SssssB', 'SsCH3', 'SdCH2', 'SssCH2', 'StCH', 'SdsCH', 'SaaCH', 'SsssCH', 'SddC', 'StsC', 'SdssC', 'SaasC', 'SaaaC', 'SssssC', 'SsNH3', 'SsNH2', 'SssNH2', 'SdNH', 'SssNH', 'SaaNH', 'StN', 'SsssNH', 'SdsN', 'SaaN', 'SsssN', 'SddsN', 'SaasN', 'SssssN', 'SsOH', 'SdO', 'SssO', 'SaaO', 'SsF', 'SsSiH3', 'SssSiH2', 'SsssSiH', 'SssssSi', 'SsPH2', 'SssPH', 'SsssP', 'SdsssP', 'SsssssP', 'SsSH', 'SdS', 'SssS', 'SaaS', 'SdssS', 'SddssS', 'SsCl', 'SsGeH3', 'SssGeH2', 'SsssGeH', 'SssssGe', 'SsAsH2', 'SssAsH', 'SsssAs', 'SsssdAs', 'SsssssAs', 'SsSeH', 'SdSe', 'SssSe', 'SaaSe', 'SdssSe', 'SddssSe', 'SsBr', 'SsSnH3', 'SssSnH2', 'SsssSnH', 'SssssSn', 'SsI', 'SsPbH3', 'SssPbH2', 'SsssPbH', 'SssssPb', 'IC0', 'IC1', 'IC2', 'IC3', 'IC4', 'IC5', 'TIC0', 'TIC1', 'TIC2', 'TIC3', 'TIC4', 'TIC5', 'SIC0', 'SIC1', 'SIC2', 'SIC3', 'SIC4', 'SIC5', 'BIC0', 'BIC1', 'BIC2', 'BIC3', 'BIC4', 'BIC5', 'CIC0', 'CIC1', 'CIC2', 'CIC3', 'CIC4', 'CIC5', 'MIC0', 'MIC1', 'MIC2', 'MIC3', 'MIC4', 'MIC5', 'ZMIC0', 'ZMIC1', 'ZMIC2', 'ZMIC3', 'ZMIC4', 'ZMIC5', 'ATS0dv', 'ATS1dv', 'ATS2dv', 'ATS3dv', 'ATS4dv', 'ATS5dv', 'ATS6dv', 'ATS7dv', 'ATS8dv', 'ATS0d', 'ATS1d', 'ATS2d', 'ATS3d', 'ATS4d', 'ATS5d', 'ATS6d', 'ATS7d', 'ATS8d', 'ATS0Z', 'ATS1Z', 'ATS2Z', 'ATS3Z', 'ATS4Z', 'ATS5Z', 'ATS6Z', 'ATS7Z', 'ATS8Z', 'ATS0m', 'ATS1m', 'ATS2m', 'ATS3m', 'ATS4m', 'ATS5m', 'ATS6m', 'ATS7m', 'ATS8m', 'ATS0v', 'ATS1v', 'ATS2v', 'ATS3v', 'ATS4v', 'ATS5v', 'ATS6v', 'ATS7v', 'ATS8v', 'ATS0se', 'ATS1se', 'ATS2se', 'ATS3se', 'ATS4se', 'ATS5se', 'ATS6se', 'ATS7se', 'ATS8se', 'ATS0pe', 'ATS1pe', 'ATS2pe', 'ATS3pe', 'ATS4pe', 'ATS5pe', 'ATS6pe', 'ATS7pe', 'ATS8pe', 'ATS0are', 'ATS1are', 'ATS2are', 'ATS3are', 'ATS4are', 'ATS5are', 'ATS6are', 'ATS7are', 'ATS8are', 'ATS0p', 'ATS1p', 'ATS2p', 'ATS3p', 'ATS4p', 'ATS5p', 'ATS6p', 'ATS7p', 'ATS8p', 'ATS0i', 'ATS1i', 'ATS2i', 'ATS3i', 'ATS4i', 'ATS5i', 'ATS6i', 'ATS7i', 'ATS8i', 'AATS0dv', 'AATS1dv', 'AATS2dv', 'AATS0d', 'AATS1d', 'AATS2d', 'AATS0Z', 'AATS1Z', 'AATS2Z', 'AATS0m', 'AATS1m', 'AATS2m', 'AATS0v', 'AATS1v', 'AATS2v', 'AATS0se', 'AATS1se', 'AATS2se', 'AATS0pe', 'AATS1pe', 'AATS2pe', 'AATS0are', 'AATS1are', 'AATS2are', 'AATS0p', 'AATS1p', 'AATS2p', 'AATS0i', 'AATS1i', 'AATS2i', 'ATSC0c', 'ATSC1c', 'ATSC2c', 'ATSC3c', 'ATSC4c', 'ATSC5c', 'ATSC6c', 'ATSC7c', 'ATSC8c', 'ATSC0dv', 'ATSC1dv', 'ATSC2dv', 'ATSC3dv', 'ATSC4dv', 'ATSC5dv', 'ATSC6dv', 'ATSC7dv', 'ATSC8dv', 'ATSC0d', 'ATSC1d', 'ATSC2d', 'ATSC3d', 'ATSC4d', 'ATSC5d', 'ATSC6d', 'ATSC7d', 'ATSC8d', 'ATSC0Z', 'ATSC1Z', 'ATSC2Z', 'ATSC3Z', 'ATSC4Z', 'ATSC5Z', 'ATSC6Z', 'ATSC7Z', 'ATSC8Z', 'ATSC0m', 'ATSC1m', 'ATSC2m', 'ATSC3m', 'ATSC4m', 'ATSC5m', 'ATSC6m', 'ATSC7m', 'ATSC8m', 'ATSC0v', 'ATSC1v', 'ATSC2v', 'ATSC3v', 'ATSC4v', 'ATSC5v', 'ATSC6v', 'ATSC7v', 'ATSC8v', 'ATSC0se', 'ATSC1se', 'ATSC2se', 'ATSC3se', 'ATSC4se', 'ATSC5se', 'ATSC6se', 'ATSC7se', 'ATSC8se', 'ATSC0pe', 'ATSC1pe', 'ATSC2pe', 'ATSC3pe', 'ATSC4pe', 'ATSC5pe', 'ATSC6pe', 'ATSC7pe', 'ATSC8pe', 'ATSC0are', 'ATSC1are', 'ATSC2are', 'ATSC3are', 'ATSC4are', 'ATSC5are', 'ATSC6are', 'ATSC7are', 'ATSC8are', 'ATSC0p', 'ATSC1p', 'ATSC2p', 'ATSC3p', 'ATSC4p', 'ATSC5p', 'ATSC6p', 'ATSC7p', 'ATSC8p', 'ATSC0i', 'ATSC1i', 'ATSC2i', 'ATSC3i', 'ATSC4i', 'ATSC5i', 'ATSC6i', 'ATSC7i', 'ATSC8i', 'AATSC0c', 'AATSC1c', 'AATSC2c', 'AATSC0dv', 'AATSC1dv', 'AATSC2dv', 'AATSC0d', 'AATSC1d', 'AATSC2d', 'AATSC0Z', 'AATSC1Z', 'AATSC2Z', 'AATSC0m', 'AATSC1m', 'AATSC2m', 'AATSC0v', 'AATSC1v', 'AATSC2v', 'AATSC0se', 'AATSC1se', 'AATSC2se', 'AATSC0pe', 'AATSC1pe', 'AATSC2pe', 'AATSC0are', 'AATSC1are', 'AATSC2are', 'AATSC0p', 'AATSC1p', 'AATSC2p', 'AATSC0i', 'AATSC1i', 'AATSC2i', 'MATS1c', 'MATS2c', 'MATS1dv', 'MATS2dv', 'MATS1Z', 'MATS2Z', 'MATS1m', 'MATS2m', 'MATS1v', 'MATS2v', 'MATS1se', 'MATS2se', 'MATS1pe', 'MATS2pe', 'MATS1are', 'MATS2are', 'MATS1p', 'MATS2p', 'MATS1i', 'MATS2i', 'GATS1c', 'GATS2c', 'GATS1dv', 'GATS2dv', 'GATS1Z', 'GATS2Z', 'GATS1m', 'GATS2m', 'GATS1v', 'GATS2v', 'GATS1se', 'GATS2se', 'GATS1pe', 'GATS2pe', 'GATS1are', 'GATS2are', 'GATS1p', 'GATS2p', 'GATS1i', 'GATS2i', 'Lipinski', 'GhoseFilter', 'Diameter', 'Radius', 'TopoShapeIndex', 'PetitjeanIndex', 'SZ', 'Sm', 'Sv', 'Sse', 'Spe', 'Sare', 'Sp', 'Si', 'MZ', 'Mm', 'Mv', 'Mse', 'Mpe', 'Mare', 'Mp', 'Mi', 'TopoPSA(NO)', 'TopoPSA', 'nRing', 'n3Ring', 'n4Ring', 'n5Ring', 'n6Ring', 'n7Ring', 'n8Ring', 'n9Ring', 'n10Ring', 'n11Ring', 'n12Ring', 'nG12Ring', 'nHRing', 'n3HRing', 'n4HRing', 'n5HRing', 'n6HRing', 'n7HRing', 'n8HRing', 'n9HRing', 'n10HRing', 'n11HRing', 'n12HRing', 'nG12HRing', 'naRing', 'n3aRing', 'n4aRing', 'n5aRing', 'n6aRing', 'n7aRing', 'n8aRing', 'n9aRing', 'n10aRing', 'n11aRing', 'n12aRing', 'nG12aRing', 'naHRing', 'n3aHRing', 'n4aHRing', 'n5aHRing', 'n6aHRing', 'n7aHRing', 'n8aHRing', 'n9aHRing', 'n10aHRing', 'n11aHRing', 'n12aHRing', 'nG12aHRing', 'nARing', 'n3ARing', 'n4ARing', 'n5ARing', 'n6ARing', 'n7ARing', 'n8ARing', 'n9ARing', 'n10ARing', 'n11ARing', 'n12ARing', 'nG12ARing', 'nAHRing', 'n3AHRing', 'n4AHRing', 'n5AHRing', 'n6AHRing', 'n7AHRing', 'n8AHRing', 'n9AHRing', 'n10AHRing', 'n11AHRing', 'n12AHRing', 'nG12AHRing', 'nFRing', 'n4FRing', 'n5FRing', 'n6FRing', 'n7FRing', 'n8FRing', 'n9FRing', 'n10FRing', 'n11FRing', 'n12FRing', 'nG12FRing', 'nFHRing', 'n4FHRing', 'n5FHRing', 'n6FHRing', 'n7FHRing', 'n8FHRing', 'n9FHRing', 'n10FHRing', 'n11FHRing', 'n12FHRing', 'nG12FHRing', 'nFaRing', 'n4FaRing', 'n5FaRing', 'n6FaRing', 'n7FaRing', 'n8FaRing', 'n9FaRing', 'n10FaRing', 'n11FaRing', 'n12FaRing', 'nG12FaRing', 'nFaHRing', 'n4FaHRing', 'n5FaHRing', 'n6FaHRing', 'n7FaHRing', 'n8FaHRing', 'n9FaHRing', 'n10FaHRing', 'n11FaHRing', 'n12FaHRing', 'nG12FaHRing', 'nFARing', 'n4FARing', 'n5FARing', 'n6FARing', 'n7FARing', 'n8FARing', 'n9FARing', 'n10FARing', 'n11FARing', 'n12FARing', 'nG12FARing', 'nFAHRing', 'n4FAHRing', 'n5FAHRing', 'n6FAHRing', 'n7FAHRing', 'n8FAHRing', 'n9FAHRing', 'n10FAHRing', 'n11FAHRing', 'n12FAHRing', 'nG12FAHRing', 'ECIndex', 'SLogP', 'SMR', 'nRot', 'RotRatio', 'MWC01', 'MWC02', 'MWC03', 'MWC04', 'MWC05', 'MWC06', 'MWC07', 'MWC08', 'MWC09', 'MWC10', 'TMWC10', 'SRW02', 'SRW03', 'SRW04', 'SRW05', 'SRW06', 'SRW07', 'SRW08', 'SRW09', 'SRW10', 'TSRW10', 'LabuteASA', 'PEOE_VSA1', 'PEOE_VSA2', 'PEOE_VSA3', 'PEOE_VSA4', 'PEOE_VSA5', 'PEOE_VSA6', 'PEOE_VSA7', 'PEOE_VSA8', 'PEOE_VSA9', 'PEOE_VSA10', 'PEOE_VSA11', 'PEOE_VSA12', 'PEOE_VSA13', 'SMR_VSA1', 'SMR_VSA2', 'SMR_VSA3', 'SMR_VSA4', 'SMR_VSA5', 'SMR_VSA6', 'SMR_VSA7', 'SMR_VSA8', 'SMR_VSA9', 'SlogP_VSA1', 'SlogP_VSA2', 'SlogP_VSA3', 'SlogP_VSA4', 'SlogP_VSA5', 'SlogP_VSA6', 'SlogP_VSA7', 'SlogP_VSA8', 'SlogP_VSA9', 'SlogP_VSA10', 'SlogP_VSA11', 'EState_VSA1', 'EState_VSA2', 'EState_VSA3', 'EState_VSA4', 'EState_VSA5', 'EState_VSA6', 'EState_VSA7', 'EState_VSA8', 'EState_VSA9', 'EState_VSA10', 'VSA_EState1', 'VSA_EState2', 'VSA_EState3', 'VSA_EState4', 'VSA_EState5', 'VSA_EState6', 'VSA_EState7', 'VSA_EState8', 'VSA_EState9', 'WPath', 'WPol', 'C1SP1', 'C2SP1', 'C1SP2', 'C2SP2', 'C3SP2', 'C1SP3', 'C2SP3', 'C3SP3', 'C4SP3', 'fragCpx', 'nAromAtom', 'nAromBond', 'MPC2', 'MPC3', 'MPC4', 'MPC5', 'MPC6', 'MPC7', 'MPC8', 'MPC9', 'MPC10', 'TMPC10', 'piPC1', 'piPC2', 'piPC3', 'piPC4', 'piPC5', 'piPC6', 'piPC7', 'piPC8', 'piPC9', 'piPC10', 'TpiPC10', 'VMcGowan', 'Xch-3d', 'Xch-4d', 'Xch-5d', 'Xch-6d', 'Xch-7d', 'Xch-3dv', 'Xch-4dv', 'Xch-5dv', 'Xch-6dv', 'Xch-7dv', 'Xc-3d', 'Xc-4d', 'Xc-5d', 'Xc-6d', 'Xc-3dv', 'Xc-4dv', 'Xc-5dv', 'Xc-6dv', 'Xpc-4d', 'Xpc-5d', 'Xpc-6d', 'Xpc-4dv', 'Xpc-5dv', 'Xpc-6dv', 'Xp-1d', 'Xp-2d', 'Xp-3d', 'Xp-4d', 'Xp-5d', 'Xp-6d', 'Xp-7d', 'AXp-1d', 'Xp-0dv', 'Xp-1dv', 'Xp-2dv', 'Xp-3dv', 'Xp-4dv', 'Xp-5dv', 'Xp-6dv', 'Xp-7dv', 'AXp-0dv', 'AXp-1dv', 'nHBAcc', 'nHBDon', 'BalabanJ', 'nAtom', 'nHeavyAtom', 'nSpiro', 'nBridgehead', 'nH', 'nB', 'nC', 'nN', 'nO', 'nS', 'nP', 'nF', 'nCl', 'nBr', 'nI', 'nX', 'MW', 'AMW', 'Kier1', 'Zagreb1', 'Zagreb2', 'mZagreb2', 'RNCG', 'RPCG', 'fMF', 'nAcid', 'nBase', 'GGI1', 'GGI2', 'GGI3', 'GGI4', 'GGI5', 'GGI6', 'GGI7', 'GGI8', 'GGI9', 'GGI10', 'JGI1', 'JGI2', 'JGI3', 'JGI4', 'JGI5', 'JGI6', 'JGI7', 'JGI8', 'JGI9', 'JGI10', 'JGT10', 'apol', 'bpol']
train_df = train_df.loc[:, k_fold_feature_selection]
test_df = test_df.loc[:, k_fold_feature_selection]
# ðŸ“Œ Korelasyonu yÃ¼ksek deÄŸiÅŸkenleri kaldÄ±rma
def correlation(dataset, threshold):
    col_corr = set()
    corr_matrix = dataset.corr()
    for i in range(len(corr_matrix.columns)):
        for j in range(i):
            if abs(corr_matrix.iloc[i, j]) > threshold:
                colname = corr_matrix.columns[i]
                col_corr.add(colname)
    return col_corr

corr_features = correlation(train_df, 0.8)
print("No. of features to drop : ", len(set(corr_features)))
train_df.drop(corr_features, axis=1, inplace=True)
test_df.drop(corr_features, axis=1, inplace=True)
filtered_list = [item for item in k_fold_feature_selection if item not in corr_features]

# ðŸ“Œ Split Features and Target
X_train = train_df.drop(columns=[target])
y_train = train_df[target]
X_test = test_df.drop(columns=[target])
y_test = test_df[target]

# ðŸ“Œ Feature Scaling (Only for Features)
scaler_X = MinMaxScaler()
X_train_scaled = pd.DataFrame(scaler_X.fit_transform(X_train), columns=X_train.columns)
X_test_scaled = pd.DataFrame(scaler_X.transform(X_test), columns=X_test.columns)

# ðŸ“Œ Target Scaling (Ensuring Proper RMSE Computation)
scaler_y = MinMaxScaler()
y_train_scaled = scaler_y.fit_transform(np.array(y_train).reshape(-1, 1)).flatten()
y_test_scaled = scaler_y.transform(np.array(y_test).reshape(-1, 1)).flatten()

# ðŸ“Œ Handle Missing Values
imputer = SimpleImputer(strategy='median')
X_train_scaled = imputer.fit_transform(X_train_scaled)
X_test_scaled = imputer.transform(X_test_scaled)

# ðŸ“Œ Define RuleFit Model
rulefit_model = RuleFit(tree_size=20, rfmode="regress", lin_standardise=True, max_iter=2000, random_state=42,)
# ðŸ“Œ Cross-Validation Setup
kf = KFold(n_splits=5, shuffle=True, random_state=42)

# ðŸ“Œ Compute Cross-Validation Predictions
cv_predictions_scaled = cross_val_predict(rulefit_model, X_train_scaled, y_train_scaled, cv=kf)

# ðŸ“Œ Convert Cross-Validation Predictions Back to Original Scale
cv_predictions_original = scaler_y.inverse_transform(cv_predictions_scaled.reshape(-1, 1)).flatten()
y_train_original = scaler_y.inverse_transform(y_train_scaled.reshape(-1, 1)).flatten()

# ðŸ“Œ Compute RMSE & RÂ² for Cross-Validation in Original Scale
r2_cv = r2_score(y_train_original, cv_predictions_original)
rmse_cv = sqrt(mean_squared_error(y_train_original, cv_predictions_original))

# ðŸ“Œ Train RuleFit Model
rulefit_model.fit(X_train_scaled, y_train_scaled, feature_names=filtered_list)

# ðŸ“Œ Compute Training Set Performance
y_train_pred_scaled = rulefit_model.predict(X_train_scaled)
y_train_pred_original = scaler_y.inverse_transform(y_train_pred_scaled.reshape(-1, 1)).flatten()
r2_train = r2_score(y_train_original, y_train_pred_original)

# ðŸ“Œ Compute Test Set Predictions
y_test_pred_scaled = rulefit_model.predict(X_test_scaled)
y_test_pred_original = scaler_y.inverse_transform(y_test_pred_scaled.reshape(-1, 1)).flatten()
r2_test = r2_score(y_test.values, y_test_pred_original)
rmse_test = sqrt(mean_squared_error(y_test.values, y_test_pred_original))

# ðŸ“Œ Print Model Performance Summary
print("\nðŸ“Œ Model Performance Summary:")
print(f"âž¡ RÂ² (Cross Validation): {r2_cv:.4f}")
print(f"âž¡ RMSE (Cross Validation): {rmse_cv:.4f}")
print(f"âž¡ RÂ² (Training Set): {r2_train:.4f}")
print(f"âž¡ RÂ² (Test Set) - RuleFit: {r2_test:.4f}")
print(f"âž¡ RMSE (Test Set) - RuleFit: {rmse_test:.4f}")

# ðŸ“Œ Save RuleFit Model
with open("inter-pol_model_finger_print.pkl", "wb") as file:
    pickle.dump(rulefit_model, file)

# ðŸ“Œ Save Predictions
predictions_df = test_df.copy()
predictions_df["Actual"] = y_test.values
predictions_df["RuleFit_Predicted"] = y_test_pred_original
predictions_df.to_excel("predictions_RuleFit.xlsx", index=False)

print("\nâœ… RuleFit Model saved as 'rulefit_model.pkl'")
print("âœ… Predictions saved to 'predictions_RuleFit.xlsx'")

